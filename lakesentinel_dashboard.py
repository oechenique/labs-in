
import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go

# Configuración
st.set_page_config(layout="wide", page_title="LakeSentinel Dashboard")

# Datos hardcodeados (los que acabás de generar)
df_data = [{'tabla_consume': 'tbp_def_alfabeta__ws_potencia', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 115, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:34', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_validacion_ean_rofina_vs_ims', 'base_origen': 'generado por the black puma y roemmers', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 2309, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:36', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__clientes_comercial', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 41166, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:37', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_cabecera_venta_directa', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 723125, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:38', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_canal_distribucion_venta_directa', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 42, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:38', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_tipo_venta_indirecta', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 2, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:39', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_tipo_venta', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 8, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:40', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_producto', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 40698, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:41', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_maestro_ims', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 19696, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:41', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'este campo definimos no incluirlo en consume', 'base_origen': 'Generada en DL', 'existe_en_rofina': False, 'existe_en_sheets': True, 'estado_bidireccional': 'SOLO_EN_SHEETS', 'cantidad_registros': 0, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'NO EXISTE', 'error': 'Tabla no existe en Consume', 'fecha_sentinel': '2025-07-03 17:24:42', 'warnings': None, 'fecha_create_date': nan, 'fecha_modify_date': nan, 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_ciudad', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 2305, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:42', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__pm_molecula_familia', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 21441, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:43', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__producto_atc', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 19323, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:44', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_tipo_comprobante_venta_directa', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 342, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:45', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__productos_dimensiones', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 47547, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:45', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__clientes_atributos', 'base_origen': 'rof_clientes', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 29851, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:46', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_control', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 9, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:47', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_presentacion', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 239, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:48', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_estado_actualizacion_venta_indirecta', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 3, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:48', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_molecula_producto', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 22189, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:49', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_detalle_venta_indirecta', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 111161310, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:50', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_rel_fcc_pack', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 40411, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:51', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_cabecera_venta_indirecta', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 75203190, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:52', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_cantidad', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 592, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:53', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_tasa_cambio', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 68, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:53', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_marca', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 16079, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:54', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__etmaterialestvm1', 'base_origen': 'rof_materiales', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 263, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:55', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_region_comercial', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 3, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:56', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_estado_venta_indirecta', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 16, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:56', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__etmaterialest178t', 'base_origen': 'rof_materiales', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 36, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:57', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_codigo_postal', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 18552, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:58', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__clientes_servicio_uri', 'base_origen': '', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 648, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:24:59', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__productos_maestro', 'base_origen': 'rof_materiales', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 22620, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:00', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_articulo_precio', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 0, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'NO EXISTE', 'error': 'Tabla no existe', 'fecha_sentinel': '2025-07-03 17:25:00', 'warnings': None, 'fecha_create_date': nan, 'fecha_modify_date': nan, 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__atc', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 5509, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:01', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_forma_farmaceutica', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 67, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:01', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_clase_terapeutica', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 163, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:02', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_canal', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 3, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:03', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__productos_ean', 'base_origen': '', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 11344, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:04', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_columna', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 47336, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:05', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_validacion_ean_alfabeta_vs_ims', 'base_origen': 'generado por the black puma y roemmers', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 15909, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:05', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_condicion_pago_venta_directa', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 1890, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:06', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_zona_venta', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 57, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:07', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_total_historial_ean_rofina', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 57, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:08', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_total_mapeo_producto', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 68676, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:08', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_sales_force', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 1, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:09', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_molecula', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 3514, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:10', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_historico_producto', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 1550, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:11', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rel_mapeo_producto_clases_terapeuticas', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 27484, 'tipo_tabla_original': 'Transaccional', 'tipo_tabla_short': 'fact', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:12', 'warnings': '⚠️ No hay campo_fecha_log definido - buscando automáticamente; No hay columnas de fecha - usando create_date + modify_date como fallback', 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_tamanio', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 10, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:13', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_total_historial_ean_iqvia', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 1398, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:13', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_estado_actualizacion_indirecta', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 0, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'NO EXISTE', 'error': 'Tabla no existe', 'fecha_sentinel': '2025-07-03 17:25:14', 'warnings': None, 'fecha_create_date': nan, 'fecha_modify_date': nan, 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_validacion_ean_rofina_vs_alfabeta', 'base_origen': 'generado por the black puma y roemmers', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 2309, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:14', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__clientes_maestro_ventas', 'base_origen': 'rof_clientes', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 851300, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:15', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_detalle_cliente', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 81065, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:16', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__productos_condiciones_venta', 'base_origen': '', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 101273, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:17', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_estado_item_venta_indirecta', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 28, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:18', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_laboratorio', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 793, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:18', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__etmaterialestvm2', 'base_origen': 'rof_materiales', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 185, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:19', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__etmaterialestvm4', 'base_origen': 'rof_materiales', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 6, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:20', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_stg_iqvia__pm_molecula_familia', 'base_origen': 'Generada en DL', 'existe_en_rofina': False, 'existe_en_sheets': True, 'estado_bidireccional': 'SOLO_EN_SHEETS', 'cantidad_registros': 0, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'NO EXISTE', 'error': 'Tabla no existe en Consume', 'fecha_sentinel': '2025-07-03 17:25:20', 'warnings': None, 'fecha_create_date': nan, 'fecha_modify_date': nan, 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__pm_molecula_producto', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 34172, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:21', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_reporte', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 47336, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:21', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_droga_resumida', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 3832, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:22', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_reporte_mensual', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 33414945, 'tipo_tabla_original': 'Transaccional', 'tipo_tabla_short': 'fact', 'campo_fecha_log_definido': 'periodo_auditado', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:23', 'warnings': None, 'fecha_create_date': nan, 'fecha_modify_date': nan, 'fecha_periodo_auditado': '2025-03-01 00:00:00', 'campo_fecha_controlado': 'periodo_auditado'}, {'tabla_consume': 'tbp_def_rof__productos_jerarquia', 'base_origen': 'rof_materiales', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 19126, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:27', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia__ddd_distrito_comercial', 'base_origen': 'iqvia_ddd', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 8, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:28', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_vendedor_detalle_venta_directa', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 814643, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:28', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_cliente', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 80514, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:29', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_rof__etmaterialestvm3', 'base_origen': 'rof_materiales', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 52, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:30', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_accion', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 1061, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:31', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_articulo', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 52567, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:31', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta__ws_via', 'base_origen': 'alfabeta_ws', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 33, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:32', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_tipo_cambio_venta_directa', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 832, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:33', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_detalle_venta_directa', 'base_origen': 'No definido', 'existe_en_rofina': True, 'existe_en_sheets': False, 'estado_bidireccional': 'SOLO_EN_CONSUME', 'cantidad_registros': 19911520, 'tipo_tabla_original': 'Desconocido', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:34', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_iqvia_flexview', 'base_origen': 'iqvia_flexview', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 2105701, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:34', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}, {'tabla_consume': 'tbp_def_alfabeta_producto_ean', 'base_origen': 'Generada en DL', 'existe_en_rofina': True, 'existe_en_sheets': True, 'estado_bidireccional': 'EN_AMBAS', 'cantidad_registros': 47669, 'tipo_tabla_original': 'Dominio', 'tipo_tabla_short': 'dim', 'campo_fecha_log_definido': 'No definido', 'estado': 'OK', 'error': None, 'fecha_sentinel': '2025-07-03 17:25:35', 'warnings': None, 'fecha_create_date': '2025-07-03', 'fecha_modify_date': '2025-07-03', 'fecha_periodo_auditado': nan, 'campo_fecha_controlado': nan}]
df_validation = pd.DataFrame(df_data)

st.markdown("# 🚗 LakeSentinel - Monitor de Data Lake")

# Preparar datos básicos
total_tablas = len(df_validation)

# Estados bidireccionales
if 'estado_bidireccional' in df_validation.columns:
    en_ambas = len(df_validation[df_validation['estado_bidireccional'] == 'EN_AMBAS'])
    porcentaje_cobertura = (en_ambas / total_tablas * 100) if total_tablas > 0 else 0
else:
    porcentaje_cobertura = 0

# Layout con columnas
col1, col2, col3 = st.columns([1, 1, 1])

with col1:
    st.markdown("### 📊 Cobertura General")
    
    # Gauge simple con Plotly
    fig_gauge = go.Figure(go.Indicator(
        mode = "gauge+number",
        value = porcentaje_cobertura,
        title = {'text': "% Cobertura"},
        gauge = {
            'axis': {'range': [None, 100]},
            'bar': {'color': "#58D9F9"},
            'steps': [
                {'range': [0, 50], 'color': "#ffcccc"},
                {'range': [50, 80], 'color': "#ffffcc"},
                {'range': [80, 100], 'color': "#ccffcc"}
            ],
        }
    ))
    fig_gauge.update_layout(height=300)
    st.plotly_chart(fig_gauge, use_container_width=True)
    
    # Métricas básicas
    st.metric("Total Tablas", f"{total_tablas:,}")
    if 'estado_bidireccional' in df_validation.columns:
        st.metric("En Ambas", f"{en_ambas:,}")

with col2:
    st.markdown("### 🏗️ Por Base de Origen")
    
    if 'base_origen' in df_validation.columns:
        # Pie chart por base origen
        base_counts = df_validation['base_origen'].value_counts()
        
        fig_pie = px.pie(
            values=base_counts.values,
            names=base_counts.index,
            title="Distribución por Base"
        )
        fig_pie.update_layout(height=300)
        st.plotly_chart(fig_pie, use_container_width=True)
        
        # Mostrar conteos
        st.markdown("**Conteos:**")
        for base, count in base_counts.items():
            st.write(f"• {base}: {count}")
    else:
        st.warning("No hay columna 'base_origen'")

with col3:
    st.markdown("### 🔄 Estados")
    
    if 'estado_bidireccional' in df_validation.columns:
        # Bar chart por estados
        estado_counts = df_validation['estado_bidireccional'].value_counts()
        
        colors = ['#FF0000', '#FF7D00', '#00FF00']  # Rojo, Naranja, Verde
        
        fig_bar = go.Figure(data=[
            go.Bar(
                x=estado_counts.index,
                y=estado_counts.values,
                marker_color=colors[:len(estado_counts)]
            )
        ])
        fig_bar.update_layout(
            title="Estados Bidireccionales",
            height=300
        )
        st.plotly_chart(fig_bar, use_container_width=True)
        
        # Mostrar conteos
        st.markdown("**Estados:**")
        for estado, count in estado_counts.items():
            st.write(f"• {estado}: {count}")
    else:
        st.warning("No hay columna 'estado_bidireccional'")

# Tabla simple de datos
st.markdown("### 📋 Detalle de Tablas")

# Seleccionar columnas básicas para mostrar
columnas_mostrar = ['tabla_consume']

if 'base_origen' in df_validation.columns:
    columnas_mostrar.append('base_origen')
if 'estado_bidireccional' in df_validation.columns:
    columnas_mostrar.append('estado_bidireccional')
if 'cantidad_registros' in df_validation.columns:
    columnas_mostrar.append('cantidad_registros')

st.dataframe(df_validation[columnas_mostrar], use_container_width=True)
